---
title: "Team Pollute"
author: "Elise, Steph, Mitchell"
date: "March 4, 2016"
output: ioslides_presentation
runtime: shiny
theme: readable
---

```{r setup, echo=F}
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(ggvis))
suppressPackageStartupMessages(library(ggplot2))
```

## Team Pollute

- Our dataset
- Introduce your topic, providing specific scientific questions and problem statements.

## Goals

- Clearly communicate hotspots of pollution in the EU
- Find differences in pollution levels between background and traffic areas
- Discover which countries/cities exceed pollution standards

## Pollution Hotspots

```{r Pollution Hotspots}

```

## Background vs Traffic

```{r BG vs Traffic, echo=F}

pollutants = c("PM10", "NO2", "O3", "PM2.5", "BaP", "SO2")

library(shiny)
ui = fluidPage(

  selectInput("dataset", "Pollutant:", pollutants),
  
  plotOutput(outputId = "main_plot", height = "300px"),
  
  textOutput("textx1")
  
  )

server = function(input, output) {
  
  # Data wrangling
  for  (i in 1:length(pollutants)){
    DataTable = read_excel('data/EU2013.xlsx', sheet=i)%>%
      mutate(`Area Type`= toupper(`type_of_station`))%>%
      mutate(pol=pollutants[i])
  
    assign(pollutants[i],DataTable)
}

    poltot = bind_rows(list(PM10, NO2, O3, PM2.5, BaP, SO2))
  
    # Reactive assignment for pollution type
    datasetInput = reactive({
     filter(poltot,pol==input$dataset)
     })
  
    # The histogram
  output$main_plot <- renderPlot({
    
    ggplot(datasetInput(), aes(statistic_value, fill = `Area Type`)) +
      geom_histogram(alpha = 0.5, aes(y = ..density..), position = 'identity', bins = 16) +
      theme_bw() +
      labs(x = "Concentration (micrograms per cubic meter")

  })
  
}
shinyApp(ui, server)
```

## Pollution Advisories

```{r Pollution Advisories, echo = TRUE}

```
